version: '2'

services:
    producer:
        image: producer
        network_mode: "host"
        volumes:
          - "/dev/shm:/dev/shm"
        privileged: true
        ulimits:
          memlock:
            soft: 4000000
            hard: 4000000
        command: "
               --camera=/dev/video0 \
               --cid=111 \
               --name=camera0 \
               --width=1280 \
               --height=720 \
               --bpp=24 \
               --freq=5"
    
    consumer:
        image: consumer
        depends_on:
          - producer
        restart: always
        network_mode: "host"
        working_dir: /opt/
        volumes:
          - "/dev/shm:/dev/shm"
          - .:/opt/
          - /tmp/.X11-unix:/tmp/.X11-unix
        environment: 
          - DISPLAY=$DISPLAY
        privileged: true
        ulimits:
          memlock:
            soft: 4000000
            hard: 4000000
        command: "
               --cid=111 \
               --name=camera0 \
               --width=1280 \
               --height=720 \
               --bpp=24 \
               --verbose"
